<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<!--
  HEIGHT BUDGET (total = 830px):
    Banner header          :  62px
    Gold stripe            :   5px
    Stat cards row         : 108px  (padding 14+12 + cards 82)
    Main HBox top margin   :  14px
    Main HBox content      : 296px  (table 296, form 296 same row)
    Emergency section      :  14px  margin-top
    Emergency content      : 215px
    Emergency margin-bot   :  16px
    Remaining / breathing  :  100px  (absorbed by VBox.vgrow on table)
  Total                   : 830px
-->

<VBox maxHeight="830.0" prefHeight="830.0" prefWidth="1420.0" spacing="0" style="-fx-background-color: #f3f4f6;" stylesheets="@../css/modern.css" xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.prison.controller.AdminManagementController">

    <!-- â•â• BANNER  62px â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <VBox maxHeight="62" minHeight="62" style="-fx-background-color: #0d2257; -fx-padding: 0 36 0 0;">
        <HBox alignment="CENTER_LEFT" spacing="0" VBox.vgrow="ALWAYS">
            <!-- Dark red accent bar on left -->
            <Region minWidth="6" style="-fx-background-color: #8b0000;" />
            <HBox alignment="CENTER_LEFT" spacing="14" style="-fx-padding: 0 0 0 22;" HBox.hgrow="ALWAYS">
                <Label style="-fx-font-size: 26;" text="ðŸ‘‘" />
                <VBox spacing="1">
                    <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 16; -fx-font-weight: bold;                                   -fx-text-fill: white;" text="ADMIN ACCOUNT MANAGEMENT" />
                    <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 10; -fx-font-style: italic;                                   -fx-text-fill: #7a99c0;" text="Create administrator accounts Â· Change passwords Â· Emergency recovery" />
               <padding>
                  <Insets top="15.0" />
               </padding>
                </VBox>
            </HBox>
            <Button onAction="#onRefresh" style="-fx-background-color: #ffd700; -fx-text-fill: #1a1000;                            -fx-font-family: 'Georgia'; -fx-font-size: 11; -fx-font-weight: bold;                            -fx-background-radius: 3; -fx-padding: 7 18 7 18; -fx-cursor: hand;" text="âŸ³  Refresh" />
        </HBox>
    </VBox>

    <!-- Gold stripe  5px -->
    <Region maxHeight="5" minHeight="5" prefHeight="5" style="-fx-background-color: linear-gradient(to right,#8a6200,#ffd700,#f5c400,#ffd700,#8a6200);" />

    <!-- â•â• STAT CARDS  108px (14 top + 80 cards + 14 bot) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <HBox maxHeight="108" minHeight="108" spacing="14" style="-fx-padding: 14 36 14 36; -fx-background-color: #f3f4f6;">

        <!-- Total admins -->
        <VBox alignment="TOP_LEFT" spacing="2" style="-fx-background-color: white;                      -fx-border-color: #dde4ef #dde4ef #dde4ef #1a56c4;                      -fx-border-width: 1 1 1 5; -fx-padding: 12 18 12 18;                      -fx-effect: dropshadow(gaussian,rgba(10,31,92,0.09),8,0,0,2);" HBox.hgrow="ALWAYS">
            <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 9; -fx-font-weight: bold;                           -fx-text-fill: #1a56c4;" text="ðŸ‘‘  TOTAL ADMINS" />
            <Label fx:id="totalAdminsLbl" style="-fx-font-family: 'Georgia'; -fx-font-size: 34; -fx-font-weight: bold;                           -fx-text-fill: #1a56c4; -fx-padding: 0;" text="â€”" />
            <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 9; -fx-text-fill: #aabbd0;                           -fx-font-style: italic;" text="Registered admin accounts" />
        </VBox>

        <!-- Active admins -->
        <VBox alignment="TOP_LEFT" spacing="2" style="-fx-background-color: white;                      -fx-border-color: #dde4ef #dde4ef #dde4ef #276b2e;                      -fx-border-width: 1 1 1 5; -fx-padding: 12 18 12 18;                      -fx-effect: dropshadow(gaussian,rgba(10,31,92,0.09),8,0,0,2);" HBox.hgrow="ALWAYS">
            <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 9; -fx-font-weight: bold;                           -fx-text-fill: #276b2e;" text="âœ…  ACTIVE ADMINS" />
            <Label fx:id="activeAdminsLbl" style="-fx-font-family: 'Georgia'; -fx-font-size: 34; -fx-font-weight: bold;                           -fx-text-fill: #276b2e; -fx-padding: 0;" text="â€”" />
            <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 9; -fx-text-fill: #aabbd0;                           -fx-font-style: italic;" text="Currently enabled accounts" />
        </VBox>

        <!-- Emergency key display -->
        <VBox alignment="TOP_LEFT" spacing="2" style="-fx-background-color: #fffbef;                      -fx-border-color: #ede0aa #ede0aa #ede0aa #b8960a;                      -fx-border-width: 1 1 1 5; -fx-padding: 12 18 12 18;                      -fx-effect: dropshadow(gaussian,rgba(184,150,10,0.16),8,0,0,2);" HBox.hgrow="ALWAYS">
            <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 9; -fx-font-weight: bold;                           -fx-text-fill: #7a4e00;" text="ðŸ”‘  EMERGENCY RESET KEY" />
            <Label style="-fx-font-family: monospace; -fx-font-size: 16; -fx-font-weight: bold;                           -fx-text-fill: #8b0000; -fx-padding: 4 0 4 0;" text="PRISON-RESET-2025" />
            <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 9; -fx-text-fill: #9a7840;                           -fx-font-style: italic;" text="Keep safe Â· Share only with trusted administrators" />
        </VBox>

    </HBox>

    <!-- â•â• MAIN BODY  14px top margin + 296px content â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <HBox spacing="14" style="-fx-padding: 0 36 0 36; -fx-background-color: #f3f4f6;" VBox.vgrow="ALWAYS">

        <!-- Admin accounts table â€” fills remaining height -->
        <VBox spacing="0" style="-fx-background-color: white;                      -fx-border-color: #dde4ef; -fx-border-width: 1;                      -fx-effect: dropshadow(gaussian,rgba(10,31,92,0.08),8,0,0,2);" HBox.hgrow="ALWAYS">

            <!-- Table header bar -->
            <HBox alignment="CENTER_LEFT" maxHeight="38" minHeight="38" spacing="10" style="-fx-padding: 0 16 0 16; -fx-background-color: #0d2257;                          -fx-border-color: transparent transparent #162d66 transparent;                          -fx-border-width: 0 0 1 0;">
                <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 12; -fx-font-weight: bold;                               -fx-text-fill: #c8d8f0;" text="ðŸ‘‘  Admin Accounts" />
            </HBox>

            <TableView fx:id="adminTable" style="-fx-background-color: transparent; -fx-border-color: transparent;" VBox.vgrow="ALWAYS">
                <columns>
                    <TableColumn fx:id="colRow" prefWidth="42" text="#" />
                    <TableColumn fx:id="colDisplay" prefWidth="155" text="Display Name" />
                    <TableColumn fx:id="colUsername" prefWidth="135" text="Username" />
                    <TableColumn fx:id="colCreatedAt" prefWidth="148" text="Created" />
                    <TableColumn fx:id="colLastLogin" prefWidth="148" text="Last Login" />
                    <TableColumn fx:id="colStatus" prefWidth="90" text="Status" />
                    <TableColumn fx:id="colActions" prefWidth="160" text="Actions" />
                </columns>
            </TableView>
        </VBox>

        <!-- Create / Change Password form â€” fixed 288px wide -->
        <VBox maxWidth="288" minWidth="288" prefWidth="288" spacing="8" style="-fx-background-color: white;                      -fx-border-color: #dde4ef; -fx-border-width: 1;                      -fx-effect: dropshadow(gaussian,rgba(10,31,92,0.08),8,0,0,2);">

            <!-- Form header bar -->
            <HBox alignment="CENTER_LEFT" maxHeight="38" minHeight="38" style="-fx-padding: 0 16 0 16; -fx-background-color: #0d2257;                          -fx-border-color: transparent transparent #162d66 transparent;                          -fx-border-width: 0 0 1 0;">
                <Label fx:id="formTitle" style="-fx-font-family: 'Georgia'; -fx-font-size: 12; -fx-font-weight: bold;                               -fx-text-fill: #c8d8f0;" text="âž•  New Admin Account" />
            </HBox>

            <VBox spacing="8" style="-fx-padding: 12 16 12 16;">

                <!-- Display Name -->
                <VBox spacing="3">
                    <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 10; -fx-font-weight: bold;                                   -fx-text-fill: #374151;" text="Display Name" />
                    <TextField fx:id="fldDisplayName" promptText="e.g. John Smith" style="-fx-background-radius: 3; -fx-border-radius: 3;                                       -fx-border-color: #d0d8e8; -fx-padding: 6;                                       -fx-font-family: 'Georgia'; -fx-font-size: 12;" />
                </VBox>

                <!-- Username -->
                <VBox spacing="3">
                    <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 10; -fx-font-weight: bold;                                   -fx-text-fill: #374151;" text="Username" />
                    <TextField fx:id="fldUsername" promptText="4â€“30 chars, letters/digits/_" style="-fx-background-radius: 3; -fx-border-radius: 3;                                       -fx-border-color: #d0d8e8; -fx-padding: 6;                                       -fx-font-family: 'Georgia'; -fx-font-size: 12;" />
                </VBox>

                <!-- Password + strength -->
                <VBox spacing="3">
                    <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 10; -fx-font-weight: bold;                                   -fx-text-fill: #374151;" text="Password" />
                    <PasswordField fx:id="fldPassword" promptText="Min 8 chars" style="-fx-background-radius: 3; -fx-border-radius: 3;                                           -fx-border-color: #d0d8e8; -fx-padding: 6;                                           -fx-font-family: 'Georgia'; -fx-font-size: 12;" />
                    <HBox alignment="CENTER_LEFT" spacing="8">
                        <ProgressBar fx:id="barStrength" prefHeight="5" prefWidth="130" progress="0" />
                        <Label fx:id="lblStrength" style="-fx-font-family: 'Georgia'; -fx-font-size: 10; -fx-font-weight: bold;" text="" />
                    </HBox>
                    <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 9;                                   -fx-text-fill: #94a3b8; -fx-font-style: italic;" text="â†‘ Uppercase  Â·  â†“ Lowercase  Â·  # Digit  Â·  @ Special" />
                </VBox>

                <!-- Confirm Password -->
                <VBox spacing="3">
                    <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 10; -fx-font-weight: bold;                                   -fx-text-fill: #374151;" text="Confirm Password" />
                    <PasswordField fx:id="fldConfirm" promptText="Re-enter password" style="-fx-background-radius: 3; -fx-border-radius: 3;                                           -fx-border-color: #d0d8e8; -fx-padding: 6;                                           -fx-font-family: 'Georgia'; -fx-font-size: 12;" />
                </VBox>

                <!-- Error label -->
                <Label fx:id="lblError" maxWidth="256" style="-fx-font-family: 'Georgia'; -fx-font-size: 11; -fx-text-fill: #b02020;" text="" wrapText="true" />

                <!-- Save / Clear buttons -->
                <HBox spacing="8">
                    <Button fx:id="btnSave" maxWidth="Infinity" onAction="#onFormSave" style="-fx-background-color: #0d2257; -fx-text-fill: white;                                    -fx-font-family: 'Georgia'; -fx-font-size: 11; -fx-font-weight: bold;                                    -fx-background-radius: 3; -fx-padding: 8; -fx-cursor: hand;" text="Save" HBox.hgrow="ALWAYS" />
                    <Button onAction="#onFormClear" style="-fx-background-color: #e8ecf3; -fx-text-fill: #374151;                                    -fx-font-family: 'Georgia'; -fx-font-size: 11;                                    -fx-background-radius: 3; -fx-padding: 8 14 8 14; -fx-cursor: hand;" text="Clear" />
                </HBox>

            </VBox>
        </VBox>
    </HBox>

    <!-- â•â• EMERGENCY RESET  14px top-margin + 215px content + 16px bot â•â•â• -->
    <VBox spacing="0" style="-fx-background-color: white;                  -fx-border-color: #e8cc60; -fx-border-width: 2;                  -fx-effect: dropshadow(gaussian,rgba(184,150,10,0.14),8,0,0,2);">
        <VBox.margin>
            <Insets bottom="16" left="36" right="36" top="14" />
        </VBox.margin>

        <!-- Section header  40px -->
        <HBox alignment="CENTER_LEFT" maxHeight="40" minHeight="40" spacing="12" style="-fx-padding: 0 18 0 18; -fx-background-color: #fffbef;                      -fx-border-color: transparent transparent #e8cc60 transparent;                      -fx-border-width: 0 0 1 0;">
            <Label style="-fx-font-size: 16;" text="ðŸš¨" />
            <VBox spacing="1">
                <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 12; -fx-font-weight: bold;                               -fx-text-fill: #7a4e00;" text="EMERGENCY PASSWORD RESET" />
                <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 9; -fx-font-style: italic;                               -fx-text-fill: #b8960a;" text="Use when an admin is locked out. Requires the master reset key shown in the card above." />
            </VBox>
        </HBox>

        <!-- Reset form fields  â‰ˆ 140px -->
        <HBox alignment="CENTER_LEFT" spacing="14" style="-fx-padding: 12 18 10 18;">

            <!-- Master key -->
            <VBox prefWidth="200" spacing="4">
                <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 10; -fx-font-weight: bold;                               -fx-text-fill: #7a4e00;" text="ðŸ”‘  Master Reset Key" />
                <TextField fx:id="fldMasterKey" promptText="Enter key exactly" style="-fx-background-radius: 3; -fx-border-radius: 3;                                   -fx-border-color: #e8cc60; -fx-border-width: 2;                                   -fx-padding: 7; -fx-font-family: monospace; -fx-font-size: 12;" />
                <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 9; -fx-font-style: italic;                               -fx-text-fill: #b8960a;" text="Copy from the stat card above" />
            </VBox>

            <!-- Username -->
            <VBox prefWidth="190" spacing="4">
                <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 10; -fx-font-weight: bold;                               -fx-text-fill: #374151;" text="ðŸ‘¤  Account Username" />
                <TextField fx:id="fldResetUsername" promptText="Username to reset" style="-fx-background-radius: 3; -fx-border-radius: 3;                                   -fx-border-color: #d0d8e8; -fx-padding: 7;                                   -fx-font-family: 'Georgia'; -fx-font-size: 12;" />
                <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 9; -fx-font-style: italic;                               -fx-text-fill: #94a3b8;" text="Works for admin or co-admin" />
            </VBox>

            <!-- New password + strength -->
            <VBox prefWidth="200" spacing="4">
                <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 10; -fx-font-weight: bold;                               -fx-text-fill: #374151;" text="ðŸ”’  New Password" />
                <PasswordField fx:id="fldResetNewPw" promptText="New password" style="-fx-background-radius: 3; -fx-border-radius: 3;                                       -fx-border-color: #d0d8e8; -fx-padding: 7;                                       -fx-font-family: 'Georgia'; -fx-font-size: 12;" />
                <HBox alignment="CENTER_LEFT" spacing="6">
                    <ProgressBar fx:id="barResetStrength" prefHeight="5" prefWidth="110" progress="0" />
                    <Label fx:id="lblResetStrength" style="-fx-font-family: 'Georgia'; -fx-font-size: 9; -fx-font-weight: bold;" text="" />
                </HBox>
            </VBox>

            <!-- Confirm -->
            <VBox prefWidth="200" spacing="4">
                <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 10; -fx-font-weight: bold;                               -fx-text-fill: #374151;" text="ðŸ”’  Confirm Password" />
                <PasswordField fx:id="fldResetConfirm" promptText="Re-enter new password" style="-fx-background-radius: 3; -fx-border-radius: 3;                                       -fx-border-color: #d0d8e8; -fx-padding: 7;                                       -fx-font-family: 'Georgia'; -fx-font-size: 12;" />
                <Label style="-fx-font-family: 'Georgia'; -fx-font-size: 9; -fx-font-style: italic;                               -fx-text-fill: #94a3b8;" text="Same rules as the form above" />
            </VBox>

            <!-- Reset button â€” aligned to field baseline -->
            <VBox alignment="BOTTOM_LEFT" prefWidth="150" spacing="4">
                <Region prefHeight="24" />
                <Button maxWidth="Infinity" onAction="#onEmergencyReset" style="-fx-background-color: #8b0000; -fx-text-fill: white;                                -fx-font-family: 'Georgia'; -fx-font-size: 11; -fx-font-weight: bold;                                -fx-background-radius: 3; -fx-padding: 8 16 8 16; -fx-cursor: hand;                                -fx-effect: dropshadow(gaussian,rgba(139,0,0,0.40),6,0,0,2);" text="ðŸš¨  Reset Password" />
            </VBox>
        </HBox>

        <!-- Error label row  25px -->
        <HBox maxHeight="25" minHeight="25" style="-fx-padding: 0 18 0 18;">
            <Label fx:id="lblResetError" style="-fx-font-family: 'Georgia'; -fx-font-size: 11; -fx-text-fill: #b02020;" text="" wrapText="true" />
        </HBox>

    </VBox>

</VBox>
